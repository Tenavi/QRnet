clear
close all
load('train.mat')

k0 = [find(t == 0), length(t)+1];

figure
hold on

for i=1:n_trajectories
    plot(...
        t(k0(i):k0(i+1)-1),...
        vecnorm(X(1:4,k0(i):k0(i+1)-1)),...
        'k'...
    )
end

title('$\Vert \mathbf q \Vert$', 'interpreter', 'latex')

figure
hold on

for i=1:n_trajectories
    plot(...
        t(k0(i):k0(i+1)-1),...
        X(1,k0(i):k0(i+1)-1),...
        'k'...
    )
end

title('$q_0$', 'interpreter', 'latex')

figure
hold on

for i=1:n_trajectories
    plot3(...
        X(2,k0(i):k0(i+1)-1),...
        X(3,k0(i):k0(i+1)-1),...
        X(4,k0(i):k0(i+1)-1),...
        'k'...
    )
end

title('$\mathbf q$', 'interpreter', 'latex')

figure
hold on

for i=1:n_trajectories
    plot3(...
        X(1,k0(i):k0(i+1)-1),...
        X(2,k0(i):k0(i+1)-1),...
        U(1,k0(i):k0(i+1)-1),...
        'k'...
    )
end

title('$u_1$', 'interpreter', 'latex')

figure
hold on

for i=1:n_trajectories
    plot3(...
        X(1,k0(i):k0(i+1)-1),...
        X(2,k0(i):k0(i+1)-1),...
        V(1,k0(i):k0(i+1)-1),...
        'k'...
    )
end

title('$V$', 'interpreter', 'latex')

% for j=1:2
%     figure
%     hold on
% 
%     for i=1:n_trajectories
%         plot3(...
%             X(1,k0(i):k0(i+1)-1),...
%             X(2,k0(i):k0(i+1)-1),...
%             dVdX(j,k0(i):k0(i+1)-1),...
%             'k'...
%         )
%     end
% 
%     title(['$\lambda_', num2str(j),'$'], 'interpreter', 'latex')
% end