function [pn_dot,pe_dot,pd_dot] = pos_dynamics(q0,q1,q2,q3,u,v,w)
    R = [
        [q0.^2 + q1.^2 - q2.^2 - q3.^3,...
        2*(q1.*q2 - q0.*q3),...
        2*(q1.*q3 + q0.*q2)];
        [2*(q1.*q2 + q0.*q3),...
        (q0.^2 + q2.^2 - q1.^2 - q3.^2),...
        2*(q2.*q3 - q0.*q1)];
        [2*(q1.*q3 - q0.*q2),...
        2*(q2.*q3 + q0.*q1),...
        (q0.^2 - q1.^2 - q2.^2 + q3.^2)]
    ];
    P_dot = R * [u;v;w];
    pn_dot = P_dot(1);
    pe_dot =  P_dot(2);
    pd_dot = P_dot(3);
end

